<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Viabilidade - Est√©tica Corporal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>An√°lise de Viabilidade Financeira</h1>
                <p>Sistema de Gest√£o para Est√©tica Corporal</p>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <div class="nav-tabs">
                <button class="nav-tab active" data-section="dashboard">
                    <span class="tab-icon">üìä</span>
                    Dashboard
                </button>
                <button class="nav-tab" data-section="cadastros">
                    <span class="tab-icon">üìã</span>
                    Cadastros
                </button>
                <button class="nav-tab" data-section="calculos">
                    <span class="tab-icon">üßÆ</span>
                    C√°lculos
                </button>
                <button class="nav-tab" data-section="simulacoes">
                    <span class="tab-icon">üìà</span>
                    Simula√ß√µes
                </button>
                <button class="nav-tab" data-section="relatorios">
                    <span class="tab-icon">üìã</span>
                    Relat√≥rios
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Se√ß√£o Dashboard -->
            <section class="app-section active" id="dashboard">
                <div class="section-header">
                    <h2>Dashboard</h2>
                    <p>Vis√£o geral do neg√≥cio e controles principais</p>
                </div>

                <!-- Bot√µes de Controle -->
                <div class="dashboard-controls">
                    <button class="btn btn--primary" onclick="salvarDados()">üíæ Salvar Dados</button>
                    <button class="btn btn--secondary" onclick="document.getElementById('backupFile').click()">üìÅ Carregar Backup</button>
                    <input type="file" id="backupFile" accept=".json" style="display: none;" onchange="carregarBackup(event)">
                    <button class="btn btn--outline" onclick="limparDados()">üóëÔ∏è Limpar Dados</button>
                    <button class="btn btn--outline" onclick="imprimirRelatorio()">üñ®Ô∏è Imprimir</button>
                </div>

                <!-- Indicadores Principais -->
                <div class="indicadores-container">
                    <div class="indicador-card">
                        <h4>Receita Mensal</h4>
                        <div class="indicador-valor" id="receitaMensal">R$ 0,00</div>
                    </div>
                    <div class="indicador-card">
                        <h4>Ticket M√©dio</h4>
                        <div class="indicador-valor" id="ticketMedioDash">R$ 0,00</div>
                    </div>
                    <div class="indicador-card">
                        <h4>Margem M√©dia</h4>
                        <div class="indicador-valor" id="margemMediaDash">0%</div>
                    </div>
                    <div class="indicador-card">
                        <h4>Resultado Mensal</h4>
                        <div class="indicador-valor" id="resultadoMensalDash">R$ 0,00</div>
                    </div>
                </div>

                <!-- Gr√°ficos Dashboard -->
                <div class="dashboard-charts">
                    <div class="card">
                        <div class="card__header">
                            <h3>Receita por Servi√ßo</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="receitaPorServicoChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card__header">
                            <h3>Composi√ß√£o de Custos</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="custosComposicaoChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o Cadastros -->
            <section class="app-section" id="cadastros">
                <div class="section-header">
                    <h2>Cadastros</h2>
                    <p>Gerencie servi√ßos, produtos, materiais e par√¢metros</p>
                </div>

                <div class="cadastros-grid">
                    <!-- 1. Servi√ßos -->
                    <div class="card">
                        <div class="card__header">
                            <h3>1. Servi√ßos</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarServico()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="servicosTable">
                                    <thead>
                                        <tr>
                                            <th>C√≥digo</th>
                                            <th>Nome</th>
                                            <th>Dura√ß√£o (min)</th>
                                            <th>Categoria</th>
                                            <th>Margem (%)</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="servicosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Produtos (para venda) -->
                    <div class="card">
                        <div class="card__header">
                            <h3>2. Produtos (para venda)</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarProduto()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="produtosTable">
                                    <thead>
                                        <tr>
                                            <th>C√≥digo</th>
                                            <th>Nome</th>
                                            <th>Custo (R$)</th>
                                            <th>Margem (%)</th>
                                            <th>Categoria</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="produtosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Materiais -->
                    <div class="card">
                        <div class="card__header">
                            <h3>3. Materiais</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarMaterial()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="materiaisTable">
                                    <thead>
                                        <tr>
                                            <th>C√≥digo</th>
                                            <th>Nome</th>
                                            <th>Custo Unit. (R$)</th>
                                            <th>Rendimento</th>
                                            <th>Unidade</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="materiaisTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Equipamentos -->
                    <div class="card">
                        <div class="card__header">
                            <h3>4. Equipamentos</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarEquipamento()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="equipamentosTable">
                                    <thead>
                                        <tr>
                                            <th>C√≥digo</th>
                                            <th>Nome</th>
                                            <th>Custo Aquisi√ß√£o (R$)</th>
                                            <th>Vida √ötil (meses)</th>
                                            <th>Custo/Hora (R$)</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="equipamentosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Funcion√°rios CLT -->
                    <div class="card">
                        <div class="card__header">
                            <h3>5. Funcion√°rios CLT</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarFuncionario()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="funcionariosTable">
                                    <thead>
                                        <tr>
                                            <th>Nome</th>
                                            <th>Cargo</th>
                                            <th>Sal√°rio (R$)</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="funcionariosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 6. S√≥cios -->
                    <div class="card">
                        <div class="card__header">
                            <h3>6. S√≥cios</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarSocio()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="sociosTable">
                                    <thead>
                                        <tr>
                                            <th>Nome</th>
                                            <th>Pr√≥-labore (R$)</th>
                                            <th>Participa√ß√£o (%)</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sociosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 7. Despesas Fixas -->
                    <div class="card">
                        <div class="card__header">
                            <h3>7. Despesas Fixas</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarDespesaFixa()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="despesasFixasTable">
                                    <thead>
                                        <tr>
                                            <th>Descri√ß√£o</th>
                                            <th>Valor (R$)</th>
                                            <th>Categoria</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="despesasFixasTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 8. Despesas Vari√°veis -->
                    <div class="card">
                        <div class="card__header">
                            <h3>8. Despesas Vari√°veis</h3>
                            <button class="btn btn--sm btn--primary" onclick="adicionarDespesaVariavel()">+ Adicionar</button>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="despesasVariaveisTable">
                                    <thead>
                                        <tr>
                                            <th>Descri√ß√£o</th>
                                            <th>Valor (R$)</th>
                                            <th>Observa√ß√£o</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="despesasVariaveisTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 9. Par√¢metros de Atendimento -->
                    <div class="card">
                        <div class="card__header">
                            <h3>9. Par√¢metros de Atendimento</h3>
                        </div>
                        <div class="card__body">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Horas √öteis/Dia</label>
                                    <input type="number" class="form-control" id="horasUteisPorDia" min="1" max="24">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Dias √öteis/M√™s</label>
                                    <input type="number" class="form-control" id="diasUteisPorMes" min="1" max="31">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Taxa de Ocupa√ß√£o (%)</label>
                                    <input type="number" class="form-control" id="taxaOcupacao" min="0" max="100" step="0.1">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 10. Consumo de Materiais por Servi√ßo -->
                    <div class="card full-width">
                        <div class="card__header">
                            <h3>10. Consumo de Materiais por Servi√ßo</h3>
                        </div>
                        <div class="card__body">
                            <div id="consumoMateriaisContainer">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>

                    <!-- 11. Produtos por Servi√ßo (NOVO) -->
                    <div class="card full-width">
                        <div class="card__header">
                            <h3>11. Produtos por Servi√ßo</h3>
                        </div>
                        <div class="card__body">
                            <div id="produtosPorServicoContainer">
                                <!-- Ser√° preenchido dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o C√°lculos -->
            <section class="app-section" id="calculos">
                <div class="section-header">
                    <h2>C√°lculos</h2>
                    <p>Custos calculados automaticamente com markup individual</p>
                </div>

                <div class="calculos-container">
                    <!-- Custo por Servi√ßos -->
                    <div class="card">
                        <div class="card__header">
                            <h3>Custo por Servi√ßos</h3>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="calculosServicosTable">
                                    <thead>
                                        <tr>
                                            <th>Servi√ßo</th>
                                            <th>Custo Material (R$)</th>
                                            <th>Custo M√£o Obra (R$)</th>
                                            <th>Custo Equipamento (R$)</th>
                                            <th>Custo Fixo Rateado (R$)</th>
                                            <th>Custo Total (R$)</th>
                                            <th>Pre√ßo Sugerido (R$)</th>
                                            <th>Margem (%)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="calculosServicosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Custo por Produtos (Venda) -->
                    <div class="card">
                        <div class="card__header">
                            <h3>Custo por Produtos (Venda)</h3>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table" id="calculosProdutosTable">
                                    <thead>
                                        <tr>
                                            <th>Produto</th>
                                            <th>Custo Produto (R$)</th>
                                            <th>Custo Rateado (R$)</th>
                                            <th>Custo Total (R$)</th>
                                            <th>Pre√ßo Venda (R$)</th>
                                            <th>Margem (%)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="calculosProdutosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o Simula√ß√µes -->
            <section class="app-section" id="simulacoes">
                <div class="section-header">
                    <h2>Simula√ß√µes</h2>
                    <p>Cen√°rios de ocupa√ß√£o e an√°lise de sensibilidade</p>
                </div>

                <div class="simulacoes-grid">
                    <div class="card">
                        <div class="card__header">
                            <h3>Cen√°rios de Taxa de Ocupa√ß√£o</h3>
                        </div>
                        <div class="card__body">
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Cen√°rio</th>
                                            <th>Taxa Ocupa√ß√£o</th>
                                            <th>Sess√µes/M√™s</th>
                                            <th>Receita Mensal (R$)</th>
                                            <th>Custo Vari√°vel (R$)</th>
                                            <th>Resultado (R$)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="cenariosTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__header">
                            <h3>Gr√°fico de Receita por Cen√°rio</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="receitaChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o Relat√≥rios -->
            <section class="app-section" id="relatorios">
                <div class="section-header">
                    <h2>Relat√≥rios</h2>
                    <p>DRE, indicadores e an√°lise de viabilidade</p>
                </div>

                <div class="relatorios-grid" id="relatorioImpressao">
                    <!-- Indicadores Principais -->
                    <div class="indicadores-container">
                        <div class="indicador-card">
                            <h4>Ticket M√©dio</h4>
                            <div class="indicador-valor" id="ticketMedio">R$ 0,00</div>
                        </div>
                        <div class="indicador-card">
                            <h4>Custo por Sess√£o</h4>
                            <div class="indicador-valor" id="custoPorSessao">R$ 0,00</div>
                        </div>
                        <div class="indicador-card">
                            <h4>Faturamento/Hora</h4>
                            <div class="indicador-valor" id="faturamentoHora">R$ 0,00</div>
                        </div>
                        <div class="indicador-card">
                            <h4>Margem Contribui√ß√£o</h4>
                            <div class="indicador-valor" id="margemContribuicao">0%</div>
                        </div>
                    </div>

                    <!-- DRE Simplificado -->
                    <div class="card">
                        <div class="card__header">
                            <h3>DRE Simplificado (Mensal)</h3>
                        </div>
                        <div class="card__body">
                            <div class="dre-container">
                                <div class="dre-linha">
                                    <span>Receita Bruta</span>
                                    <span id="receitaBruta">R$ 0,00</span>
                                </div>
                                <div class="dre-linha">
                                    <span>(-) Custos Vari√°veis</span>
                                    <span id="custosVariaveis">R$ 0,00</span>
                                </div>
                                <div class="dre-linha margem">
                                    <span><strong>= Margem de Contribui√ß√£o</strong></span>
                                    <span id="margemContribuicaoValor"><strong>R$ 0,00</strong></span>
                                </div>
                                <div class="dre-linha">
                                    <span>(-) Custos Fixos</span>
                                    <span id="custosFixosTotal">R$ 0,00</span>
                                </div>
                                <div class="dre-linha resultado">
                                    <span><strong>= Resultado L√≠quido</strong></span>
                                    <span id="resultadoLiquido"><strong>R$ 0,00</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gr√°fico de Composi√ß√£o de Custos -->
                    <div class="card">
                        <div class="card__header">
                            <h3>Composi√ß√£o de Custos</h3>
                        </div>
                        <div class="card__body">
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="custosChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- An√°lise de Viabilidade -->
                    <div class="card viabilidade-card">
                        <div class="card__header">
                            <h3>An√°lise de Viabilidade</h3>
                        </div>
                        <div class="card__body">
                            <div class="viabilidade-resultado" id="viabilidadeResultado">
                                <div class="status-indicator" id="statusViabilidade">
                                    <span class="status" id="statusBadge">Analisando...</span>
                                </div>
                                <div class="recomendacoes" id="recomendacoes">
                                    <h4>Recomenda√ß√µes:</h4>
                                    <ul id="listaRecomendacoes">
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>